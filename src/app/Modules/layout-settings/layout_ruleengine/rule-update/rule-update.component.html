<div class="form_bg">
  <mat-card class="p-0">
    <mat-card-title class="">
      <div class="card-title-text">Update Layout Rule Engine</div>
      <mat-divider></mat-divider>
    </mat-card-title>
    <mat-card-content class="pb-0">
      <form [formGroup]="ruleengineForm" class="category">
        <div fxLayout="row wrap" class="mt-24">
          <div fxFlex="100" fxFlex.gt-xs="100" class="pr-1">
            <div class="pb-1">
              <mat-form-field class="full-width" appearance="outline">
                <mat-label> Layout Category Name<span class="red_color">*</span></mat-label>
                <mat-select formControlName="layoutId">
                  <mat-option *ngFor="let position of dataSource" [value]="position.layoutId">
                    {{position.layoutCategoryName}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="ruleengineForm.controls['layoutId'].hasError('required') 
                              && ruleengineForm.controls['layoutId'].touched" class="form-error-msg">Please choose
                  department
                </mat-error>
              </mat-form-field>
            </div>
          </div>
        </div>
        <div fxLayout="row wrap" class="mt-24">
          <div fxFlex="100" fxFlex.gt-xs="100" class="pr-1">
            <div class="pb-1">
              <mat-form-field class="full-width" appearance="outline">
                <mat-label> Layout Position Name<span class="red_color">*</span></mat-label>
                <mat-select formControlName="positionId">
                  <mat-option *ngFor="let position of Position" [value]="position.positionId">
                    {{position.positionShortName}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="ruleengineForm.controls['positionId'].hasError('required') 
                              && ruleengineForm.controls['positionId'].touched" class="form-error-msg">Please choose
                  department
                </mat-error>
              </mat-form-field>
            </div>
          </div>
        </div>
        <div fxLayout="row wrap" class="">
          <div fxFlex="100" fxFlex.gt-xs="10">
          </div>
        </div>
        <div fxLayout="row wrap" class="mb-24">
          <div fxFlex="100" fxFlex.gt-xs="100" class="">
            <div class="mat-accordion">
              <div class="mat-expansion-panel">
                <div>
                  <mat-checkbox fromControlName="isEmployeeAllowed"
                    [checked]="ruleengineForm.value.isEmployeeAllowed== 1" (change)="employeeAllowControl($event)">
                    Employee
                    Allowed</mat-checkbox>
                  <div class="mt-24" *ngIf="ruleengineForm.controls.isEmployeeAllowed.value == 1">
                    <br>
                    <mat-checkbox class="pl-24" fromControlName="attendanceEnabled"
                      (change)="employeeattenanceControl($event)"
                      [checked]="ruleengineForm.value.attendanceEnabled== 1"> Is this attendance Check In / Out?
                    </mat-checkbox>
                    <div fxLayout="row wrap" class="pl-24 mt-24">
                      <div fxFlex="100" fxFlex.gt-xs="100" class="">
                        <div class="pb-1">
                          <br>
                          <mat-form-field>
                            <mat-label>Select Departmnet<span class="red_color">*</span></mat-label>
                            <mat-select formControlName="departmentId" multiple placeholder="Select Department">
                              <mat-option *ngFor="let department of departments" [value]="department.departmentId"
                                (onSelectionChange)="onItemSelect($event,department)">
                                {{ department.departmentName }}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div>
                      </div>
                    </div>
                    <div fxLayout="row wrap" class="pl-24">
                      <div fxFlex="100" fxFlex.gt-xs="100" class="">
                        <div class="pb-1">
                          <mat-form-field>
                            <mat-label>Select Designation <span class="red_color">*</span></mat-label>
                            <mat-select formControlName="designationId" multiple placeholder="Select Department">
                              <mat-option *ngFor="let position of positions" [value]="position.designationId"
                                (onSelectionChange)="onPositionChange($event,position)">
                                {{ position.designation }}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>

                        </div>
                      </div>
                    </div>
                    <div class="pl-24 mb-24">
                      <p> <label><strong>Gender</strong><span class="red_color">*</span>
                        </label></p>
                      <mat-checkbox class="mr-8" fromControlName="isEmployeeMaleAllowed"
                        (change)="employeeGenderControl($event,'male')"
                        [checked]="ruleengineForm.value.isEmployeeMaleAllowed == 1">Male</mat-checkbox>
                      <mat-checkbox class="mr-8" fromControlName="isEmployeeFemaleAllowed"
                        (change)="employeeGenderControl($event,'female')"
                        [checked]="ruleengineForm.value.isEmployeeFemaleAllowed == 1">Female</mat-checkbox>
                      <mat-checkbox class="mr-8" fromControlName="isEmployeeTransAllowed"
                        (change)="employeeGenderControl($event,'tran')"
                        [checked]="ruleengineForm.value.isEmployeeTransAllowed == 1">Transgender</mat-checkbox>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </form>
      <br>
      <br>

      <mat-card-footer class="pt-0">
        <button mat-raised-button color="primary" class="btn-primary-bg mr-12"
          (click)=" Update(ruleengineForm.value)">Save</button>
        <button mat-raised-button color="primary" class="btn-primary-bg mr-12" (click)=" discard()">Close</button>

      </mat-card-footer>

    </mat-card-content>

  </mat-card>
</div>